# ───────────────────────────────────────────────────────────────────
# Ansible Inventory — Auto-Generated by Terraform
# ───────────────────────────────────────────────────────────────────
# WARNING: This file is managed by Terraform. Do NOT edit manually.
# Any changes will be overwritten on the next `terraform apply`.
#
# Tool Installation Matrix:
# ┌───────────────────┬──────────────────────────────────────────────┐
# │ Instance          │ Ansible Roles                                │
# ├───────────────────┼──────────────────────────────────────────────┤
# │ Jenkins Master    │ java, docker, awscli, jenkins, security_tools│
# │ Worker Nodes      │ java, docker, awscli, maven, kubectl, helm   │
# │ SonarQube         │ java, docker, awscli, sonarqube, sec_tools   │
# └───────────────────┴──────────────────────────────────────────────┘
# ───────────────────────────────────────────────────────────────────

[jenkins_master]
${jenkins_master_ip} ansible_user=${ssh_user} ansible_ssh_private_key_file=${ssh_key_file} private_ip=${jenkins_master_priv}

[worker_nodes]
%{ for index, ip in worker_node_ips ~}
${ip} ansible_user=${ssh_user} ansible_ssh_private_key_file=${ssh_key_file} private_ip=${worker_node_priv_ips[index]}
%{ endfor ~}

[sonarqube]
${sonarqube_ip} ansible_user=${ssh_user} ansible_ssh_private_key_file=${ssh_key_file} private_ip=${sonarqube_priv}

# ───────────────────────────────────────────────────────────────────
# Group Aggregation — Maps to Playbook Plays
# ───────────────────────────────────────────────────────────────────

# Play 1: Core tools (java, docker, awscli) → all_nodes
[all_nodes:children]
jenkins_master
worker_nodes
sonarqube

# Play 2: Jenkins install & config → jenkins_master
# (uses [jenkins_master] group directly)

# Play 3: Build & deploy tools (maven, kubectl, helm) → build_agents
[build_agents:children]
worker_nodes

# Play 4: SonarQube stack deployment → sonarqube
# (uses [sonarqube] group directly)

# Play 5: Security scanners (trivy, checkov) → devops_tools
[devops_tools:children]
jenkins_master
sonarqube
