# ───────────────────────────────────────────────────────────────────
# Ansible Inventory — Spring PetClinic Microservices (Dev)
# ───────────────────────────────────────────────────────────────────
# SOURCE OF TRUTH: terraform/environments/dev/main.tf
#
# This file is AUTO-GENERATED by Terraform on every `terraform apply`
# via the local_file.ansible_inventory resource → inventory/hosts.
# Do NOT edit manually — any changes will be overwritten.
#
# Last synced from Terraform state: 2026-02-19
#
# Infrastructure shape (main.tf):
# ┌──────────────────────┬──────────────────┬────────────────────────────────────────────┐
# │ Terraform Module     │ Instance Type    │ Ansible Roles                              │
# ├──────────────────────┼──────────────────┼────────────────────────────────────────────┤
# │ module.jenkins_master│ t3.large         │ java, docker, awscli, jenkins              │
# │ module.worker_node   │ t3.medium        │ java, docker, awscli, maven, kubectl, helm │
# │ module.sonarqube_    │ t2.medium        │ java, docker, awscli, sonarqube            │
# │   server             │                  │                                            │
# │ all (devops_tools)   │ —                │ security_tools (trivy, checkov)            │
# └──────────────────────┴──────────────────┴────────────────────────────────────────────┘
#
# SSH user : ec2-user  (var.remote_user / ssh_user in tftpl)
# Key file : ../terraform/environments/dev/spms-dev.pem  (var.ssh_private_key_path)
# Subnet   : public_subnet_ids[0]  (all three instances share the first public subnet)
# ───────────────────────────────────────────────────────────────────

# ─── Play 2: Jenkins Master ──────────────────────────────────────
# module.jenkins_master — role = "master", instance_type = t3.large
[jenkins_master]
54.198.1.126  ansible_user=ec2-user  ansible_ssh_private_key_file=../terraform/environments/dev/spms-dev.pem  private_ip=10.0.1.111

# ─── Play 3: Worker Node(s) ──────────────────────────────────────
# module.worker_node — role = "worker", instance_type = t3.medium
# main.tf provisions a single worker. Add one line per worker if scaled out.
[worker_nodes]
54.166.219.157  ansible_user=ec2-user  ansible_ssh_private_key_file=../terraform/environments/dev/spms-dev.pem  private_ip=10.0.1.250

# ─── Play 4: SonarQube Server ────────────────────────────────────
# module.sonarqube_server — role = "sonarqube", instance_type = t2.medium
[sonarqube]
34.239.138.244  ansible_user=ec2-user  ansible_ssh_private_key_file=../terraform/environments/dev/spms-dev.pem  private_ip=10.0.1.14

# ───────────────────────────────────────────────────────────────────
# Group Aggregation — Maps to Plays in playbooks/install-tools.yml
# ───────────────────────────────────────────────────────────────────

# Play 1: Core tools (java, docker, awscli) on every node
[all_nodes:children]
jenkins_master
worker_nodes
sonarqube

# Play 3: Build & deploy tools (maven, kubectl, helm) — workers only
[build_agents:children]
worker_nodes

# Play 5: Security scanners (trivy, checkov) — CI/CD + SonarQube
[devops_tools:children]
jenkins_master
sonarqube
worker_nodes
