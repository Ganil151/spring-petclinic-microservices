---
# ───────────────────────────────────────────────────────────────────
# Playbook: Install Development Tools for Spring PetClinic
# ───────────────────────────────────────────────────────────────────
# Inventory is auto-generated by Terraform (local_file.ansible_inventory)
# Run with: ansible-playbook playbooks/install-tools.yml
# ───────────────────────────────────────────────────────────────────

- name: Install Core Tools on All Nodes
  hosts: all_nodes
  gather_facts: yes

  pre_tasks:
    - name: Display Target Node Info
      debug:
        msg: "Configuring {{ inventory_hostname }} ({{ ansible_distribution }} {{ ansible_distribution_version }})"

    - name: Wait for SSH to become available
      wait_for_connection:
        delay: 5
        timeout: 120

  roles:
    - java
    - docker
    - awscli

- name: Install Build & Deploy Tools on Worker Nodes
  hosts: build_agents
  gather_facts: no

  roles:
    - maven
    - kubectl
    - helm

- name: Install DevSecOps Tools on SonarQube & Jenkins
  hosts: devops_tools
  gather_facts: no

  roles:
    - security_tools
